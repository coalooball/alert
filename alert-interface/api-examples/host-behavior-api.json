{
  "request": {
    "method": "POST",
    "url": "/api/alerts/host-behavior/query",
    "headers": {
      "Content-Type": "application/json",
      "Authorization": "Bearer <token>"
    },
    "body": {
      "alarm_ids": [
        "HB-2024-001-ABC789",
        "HB-2024-002-DEF012",
        "HB-2024-003-GHI345",
        "HB-2024-004-JKL678"
      ]
    }
  },
  "response": {
    "code": 200,
    "message": "查询成功",
    "data": [
      {
        "alarm_id": "HB-2024-001-ABC789",
        "alarm_date": 1735142400000,
        "alarm_severity": 3,
        "alarm_name": "XMRig挖矿进程检测",
        "alarm_description": "检测到主机运行XMRig挖矿程序，占用大量CPU资源进行门罗币挖矿",
        "alarm_type": 3,
        "alarm_subtype": 3001,
        "source": 3,
        "control_rule_id": "RULE-MINING-2024-001",
        "control_task_id": "TASK-HOST-2024-300",
        "procedure_technique_id": ["T1496"],
        "session_id": "",
        "ip_version": 4,
        "src_ip": "",
        "src_port": null,
        "dst_ip": "pool.minexmr.com",
        "dst_port": 4444,
        "protocol": "TCP",
        "terminal_id": "TERM-SVR-DB-001",
        "source_file_path": "/data/logs/2024/12/25/host_142400.log",
        "host_name": "DB-SERVER-01",
        "terminal_ip": "192.168.10.50",
        "user_account": "www-data",
        "terminal_os": "Ubuntu 20.04.3 LTS",
        "dst_process_md5": "d41d8cd98f00b204e9800998ecf8427e",
        "dst_process_path": "/tmp/.system/xmrig",
        "dst_process_cli": "/tmp/.system/xmrig -o pool.minexmr.com:4444 -u wallet_address -p x",
        "src_process_md5": "a1b2c3d4e5f6789012345678901234567",
        "src_process_path": "/usr/sbin/apache2",
        "src_process_cli": "/usr/sbin/apache2 -k start",
        "register_key_name": "",
        "register_key_value": "",
        "register_path": "",
        "file_name": "xmrig",
        "file_md5": "d41d8cd98f00b204e9800998ecf8427e",
        "file_path": "/tmp/.system/xmrig"
      },
      {
        "alarm_id": "HB-2024-002-DEF012",
        "alarm_date": 1735146000000,
        "alarm_severity": 3,
        "alarm_name": "勒索软件文件加密行为",
        "alarm_description": "检测到大量文件被加密并添加.locked扩展名，疑似勒索软件攻击",
        "alarm_type": 3,
        "alarm_subtype": 3002,
        "source": 8,
        "control_rule_id": "RULE-RANSOM-2024-002",
        "control_task_id": "TASK-INCIDENT-2024-001",
        "procedure_technique_id": ["T1486", "T1490"],
        "session_id": "",
        "ip_version": null,
        "src_ip": "",
        "src_port": null,
        "dst_ip": "",
        "dst_port": null,
        "protocol": "",
        "terminal_id": "TERM-FIN-PC-010",
        "source_file_path": "/data/logs/2024/12/25/host_150000.log",
        "host_name": "FIN-WORKSTATION-10",
        "terminal_ip": "192.168.2.110",
        "user_account": "john.smith",
        "terminal_os": "Windows 10 Pro",
        "dst_process_md5": "98765432109876543210987654321098",
        "dst_process_path": "C:\\Users\\john.smith\\AppData\\Roaming\\svchost.exe",
        "dst_process_cli": "C:\\Users\\john.smith\\AppData\\Roaming\\svchost.exe --encrypt-all",
        "src_process_md5": "",
        "src_process_path": "",
        "src_process_cli": "",
        "register_key_name": "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
        "register_key_value": "C:\\Users\\john.smith\\AppData\\Roaming\\svchost.exe",
        "register_path": "HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
        "file_name": "HOW_TO_DECRYPT.txt",
        "file_md5": "",
        "file_path": "C:\\Users\\john.smith\\Desktop\\HOW_TO_DECRYPT.txt"
      },
      {
        "alarm_id": "HB-2024-003-GHI345",
        "alarm_date": 1735149600000,
        "alarm_severity": 3,
        "alarm_name": "Cobalt Strike Beacon远控检测",
        "alarm_description": "检测到Cobalt Strike Beacon与C2服务器的通信行为",
        "alarm_type": 3,
        "alarm_subtype": 3003,
        "source": 3,
        "control_rule_id": "RULE-C2-2024-003",
        "control_task_id": "0",
        "procedure_technique_id": ["T1071.001", "T1573.002"],
        "session_id": "",
        "ip_version": 4,
        "src_ip": "192.168.1.75",
        "src_port": 49200,
        "dst_ip": "185.234.218.50",
        "dst_port": 443,
        "protocol": "HTTPS",
        "terminal_id": "TERM-HR-PC-005",
        "source_file_path": "/data/logs/2024/12/25/host_160000.log",
        "host_name": "HR-PC-005",
        "terminal_ip": "192.168.1.75",
        "user_account": "hr_admin",
        "terminal_os": "Windows 11",
        "dst_process_md5": "fedcba9876543210fedcba9876543210",
        "dst_process_path": "C:\\Windows\\System32\\rundll32.exe",
        "dst_process_cli": "rundll32.exe C:\\Windows\\Temp\\msvcrt.dll,DllRegisterServer",
        "src_process_md5": "",
        "src_process_path": "C:\\Windows\\explorer.exe",
        "src_process_cli": "",
        "register_key_name": "",
        "register_key_value": "",
        "register_path": "",
        "file_name": "msvcrt.dll",
        "file_md5": "aabbccddeefffggghhhiiijjjkkklllmm",
        "file_path": "C:\\Windows\\Temp\\msvcrt.dll"
      },
      {
        "alarm_id": "HB-2024-004-JKL678",
        "alarm_date": 1735153200000,
        "alarm_severity": 2,
        "alarm_name": "SSH暴力破解攻击",
        "alarm_description": "检测到针对SSH服务的暴力破解尝试，短时间内大量失败登录",
        "alarm_type": 3,
        "alarm_subtype": 3004,
        "source": 3,
        "control_rule_id": "RULE-BRUTE-2024-004",
        "control_task_id": "TASK-SEC-2024-150",
        "procedure_technique_id": ["T1110.001"],
        "session_id": "",
        "ip_version": 4,
        "src_ip": "203.0.113.100",
        "src_port": 38956,
        "dst_ip": "192.168.5.20",
        "dst_port": 22,
        "protocol": "SSH",
        "terminal_id": "TERM-SVR-WEB-002",
        "source_file_path": "/data/logs/2024/12/25/host_170000.log",
        "host_name": "WEB-SERVER-02",
        "terminal_ip": "192.168.5.20",
        "user_account": "root",
        "terminal_os": "CentOS 7.9",
        "dst_process_md5": "",
        "dst_process_path": "/usr/sbin/sshd",
        "dst_process_cli": "/usr/sbin/sshd -D",
        "src_process_md5": "",
        "src_process_path": "",
        "src_process_cli": "",
        "register_key_name": "",
        "register_key_value": "",
        "register_path": "",
        "file_name": "",
        "file_md5": "",
        "file_path": ""
      }
    ]
  },
  "error_response": {
    "code": 401,
    "message": "认证失败",
    "error": {
      "reason": "Token已过期或无效"
    }
  },
  "response_codes": {
    "200": "请求成功",
    "400": "请求参数错误",
    "401": "未授权访问",
    "403": "权限不足",
    "404": "资源不存在",
    "500": "服务器内部错误",
    "503": "服务不可用"
  }
}