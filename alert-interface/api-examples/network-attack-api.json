{
  "request": {
    "method": "POST",
    "url": "/api/alerts/network-attack/query",
    "headers": {
      "Content-Type": "application/json",
      "Authorization": "Bearer <token>"
    },
    "body": {
      "alarm_ids": [
        "NA-2024-001-ABC123",
        "NA-2024-002-DEF456",
        "NA-2024-003-GHI789"
      ]
    }
  },
  "response": {
    "code": 200,
    "message": "查询成功",
    "data": [
      {
        "alarm_id": "NA-2024-001-ABC123",
        "alarm_date": 1735142400000,
        "alarm_severity": 3,
        "alarm_name": "APT组织Lazarus后门通信检测",
        "alarm_description": "检测到终端与已知APT组织Lazarus的C2服务器进行加密通信，存在数据泄露风险",
        "alarm_type": 1,
        "alarm_subtype": 1004,
        "source": 1,
        "control_rule_id": "RULE-APT-2024-001",
        "control_task_id": "TASK-SEC-2024-100",
        "procedure_technique_id": ["T1071.001", "T1573.001"],
        "session_id": "SESSION-20241225-142300-001",
        "ip_version": 4,
        "src_ip": "192.168.1.100",
        "src_port": 54321,
        "dst_ip": "185.234.218.100",
        "dst_port": 443,
        "protocol": "HTTPS",
        "terminal_id": "TERM-OFFICE-PC-001",
        "source_file_path": "/data/traffic/2024/12/25/capture_142300.pcap",
        "signature_id": "SIG-APT-LAZARUS-001",
        "attack_payload": "{\"tls_version\":\"1.3\",\"cipher_suite\":\"TLS_AES_256_GCM_SHA384\",\"sni\":\"update.microsoft-services.com\"}",
        "attack_stage": "Command and Control",
        "attack_ip": "185.234.218.100",
        "attacked_ip": "192.168.1.100",
        "apt_group": "Lazarus Group",
        "vul_type": "",
        "CVE_id": "",
        "vul_desc": ""
      },
      {
        "alarm_id": "NA-2024-002-DEF456",
        "alarm_date": 1735146000000,
        "alarm_severity": 2,
        "alarm_name": "SQL注入漏洞利用尝试",
        "alarm_description": "检测到针对Web应用程序的SQL注入攻击尝试，攻击者试图获取数据库信息",
        "alarm_type": 1,
        "alarm_subtype": 1003,
        "source": 2,
        "control_rule_id": "RULE-SQLI-2024-002",
        "control_task_id": "TASK-WEB-2024-050",
        "procedure_technique_id": ["T1190"],
        "session_id": "SESSION-20241225-150000-002",
        "ip_version": 4,
        "src_ip": "45.67.89.123",
        "src_port": 38745,
        "dst_ip": "10.0.1.50",
        "dst_port": 80,
        "protocol": "HTTP",
        "terminal_id": "",
        "source_file_path": "/data/traffic/2024/12/25/capture_150000.pcap",
        "signature_id": "SIG-SQLI-001",
        "attack_payload": "{\"method\":\"GET\",\"uri\":\"/products.php?id=1' OR '1'='1\",\"user_agent\":\"sqlmap/1.5\"}",
        "attack_stage": "Initial Access",
        "attack_ip": "45.67.89.123",
        "attacked_ip": "10.0.1.50",
        "apt_group": "",
        "vul_type": "SQL注入",
        "CVE_id": "CVE-2024-1234",
        "vul_desc": "应用程序未对用户输入进行适当验证，导致SQL注入漏洞"
      },
      {
        "alarm_id": "NA-2024-003-GHI789",
        "alarm_date": 1735149600000,
        "alarm_severity": 3,
        "alarm_name": "大规模端口扫描行为",
        "alarm_description": "检测到来自外部IP的大规模端口扫描行为，扫描目标为内网多个主机的常用服务端口",
        "alarm_type": 1,
        "alarm_subtype": 1001,
        "source": 1,
        "control_rule_id": "RULE-SCAN-2024-003",
        "control_task_id": "0",
        "procedure_technique_id": ["T1046"],
        "session_id": "SESSION-20241225-160000-003",
        "ip_version": 4,
        "src_ip": "203.0.113.45",
        "src_port": 12345,
        "dst_ip": "192.168.0.0/24",
        "dst_port": 3389,
        "protocol": "TCP",
        "terminal_id": "",
        "source_file_path": "/data/traffic/2024/12/25/capture_160000.pcap",
        "signature_id": "SIG-PORTSCAN-001",
        "attack_payload": "{\"scan_type\":\"SYN\",\"ports_scanned\":[22,80,443,3306,3389,8080],\"hosts_scanned\":254}",
        "attack_stage": "Reconnaissance",
        "attack_ip": "203.0.113.45",
        "attacked_ip": "192.168.0.0/24",
        "apt_group": "",
        "vul_type": "",
        "CVE_id": "",
        "vul_desc": ""
      }
    ]
  },
  "error_response": {
    "code": 400,
    "message": "请求参数错误",
    "error": {
      "field": "alarm_ids",
      "reason": "告警ID列表不能为空"
    }
  },
  "response_codes": {
    "200": "请求成功",
    "400": "请求参数错误",
    "401": "未授权访问",
    "403": "权限不足",
    "404": "资源不存在",
    "500": "服务器内部错误",
    "503": "服务不可用"
  }
}